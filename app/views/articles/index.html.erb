<button class="btn btn-info btn-block  active" onClick="location.href='/articles/new'">新しい記事を追加する</button>

<%= paginate @articles %>

<% if !@articles.empty? %>

<table class="table table-bordered table-striped">
  <tbody>
<% @articles.each do |article| %>
    <tr>
      <td>
      <a href=<%= article.url %> target=”_blank”><img src=<%= article.url_thumbnail %> alt=<%= article.url_title %> width="100"></a>
      </td>
      <td>
        <h4><a href=<%= article.url %> target=”_blank”><%= article.title %></a></h4>
        <h5><a href=<%= article.url %> target=”_blank”><%= article.url_title %></a></h5>
        <h6><%= truncate(article.url_description, length:200) %></h6>
        
        <div align="right">
        <button type="button" class="btn btn-primary btn-xs" id="<%= article.id %>" onclick="good(<%= article.id %>)">ぱねぇ！</button> 
        <span id="num<%= article.id %>"><%= article.feelings_count %></span>人
        <h6>
          <% if article.user_id.to_i == current_user.id.to_i %>
            <%= link_to '記事を削除', article, method: :delete, data: { confirm: '削除してよろしいですか？' } %>
          <% end %>
          　投稿者：<%= article.user.user_name %>　投稿日時：<%= (article.created_at).strftime("%Y/%m/%d %H:%M") %>　
        </h6>
        </div>
      </td>
    </tr>
<% end %>
  </tbody>
</table>

<%= paginate @articles %>

<script type="text/javascript">
function good(id){
  var str = "#"+id
  countUp(id)

  $.ajax({
    type: "POST",
    url: "/feelings",
    dataType: "json",
    data : {article_id : id},
    }).done(function(data, status, xhr) {
  });
}
function countUp(id){
  var str = "#num"+id;
  var val = parseInt($(str).text());
  $(str).text(String(val+1));
}
</script>

<% end %>