<header class="major">
  <h1><%= @book.title %></h1>
</header>

<div class="panel">
  <div class="panel-body">

    <h5>著者名</h5>
    <p><%= @book.author %></p>
    <h5>出版社</h5>
    <p><%= @book.publisher %></p>
    <h5>所有者</h5>
    <p><%= @book.owner %></p>

    <% if @book.user.syoko %>
      <h5>貸出日</h5>
      <p>貸出可能(<%= @book.user.place %>)</p>
      <h5>返却期限</h5>
      <p>-</p>
      <h5>利用者</h5>
      <p>-</p>
    <% else %>
      <h5>貸出日</h5>
      <p><%= (@book.updated_at).strftime("%Y-%m-%d") %></p>
      <h5>返却期限</h5>
      <p><%= (@book.updated_at + 7.days).strftime("%Y-%m-%d") %></p>
      <h5>利用者</h5>
      <p><%= @book.user.email %></p>
    <% end %>

  </div>
</div>


<% if @book.user.syoko %>
  <%= button_to '借ります！', rent_book_path(@book),
  :method => :patch, data: { confirm: '貸出処理を行いますか？' }, :class => 'btn btn-primary' %>
<% elsif @book.user_id == current_user.id %>
  <%= button_to '返します！', edit_book_path(@book), :method => :get, :class => 'btn btn-primary' %>
<% end %>

<%= button_to 'コメントする', new_book_comment_path(@book), :method => :get, :class => 'btn btn-primary' %>

<% if @comments.length != 0 %>

<table class="table">
  <thead>
    <tr>
      <!--<th>#</th>-->
      <th>コメント</th>
      <th>ユーザ名</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
      <% @comments.each do |c| %>
        <tr>
        <% if c.comment.length < 30 then %>
          <td><%= link_to c.comment, comment_path(c) %></td>
        <% else %>
          <td><%= link_to c.comment.slice(0,30) + '...', comment_path(c) %></td>
        <% end %>
        <td><%= c.user.email %></td>
        </tr>
      <% end %>
  </tbody>
</table>

<% end %>
<%#= button_to "削除", { :action => "rent", :id => @book.id }, :confirm => "本当に削除しますか?" %>
<%#if current_user.id == @book.user_id %>
  <%#= link_to 'Destroy', @book, method: :delete,  %>
<%# end %>
